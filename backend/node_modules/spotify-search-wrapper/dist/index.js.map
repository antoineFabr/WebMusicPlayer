{"version":3,"sources":["../src/index.ts","../src/utils/index.ts","../src/search/index.ts","../src/tools/index.ts"],"sourcesContent":["import { getPlaylist, getTrackInfo, searchTrack, searchPlaylist } from \"./search\";\r\nimport { validateID } from \"./tools\";\r\n\r\nexport { getPlaylist, getTrackInfo, searchTrack, searchPlaylist, validateID };\r\n","import { load } from \"cheerio\";\r\n\r\nexport const getSpotifyToken = async (): Promise<string | null> => {\r\n\ttry {\r\n\t\tconst url = \"https://open.spotify.com\";\r\n\t\tconst response = await fetch(url, {\r\n\t\t\theaders: {\r\n\t\t\t\t\"User-Agent\":\r\n\t\t\t\t\t\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36\",\r\n\t\t\t},\r\n\t\t});\r\n\t\tconst data = await response.text();\r\n\r\n\t\tconst $ = load(data);\r\n\t\tconst spotifySession = $(\"#session\").html();\r\n\r\n\t\tif (!spotifySession) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst { accessToken } = JSON.parse(spotifySession);\r\n\r\n\t\treturn accessToken;\r\n\t} catch (error) {\r\n\t\tthrow new Error(\"Error scraping Spotify: \" + error);\r\n\t}\r\n};\r\n\r\nexport const fetchFromSpotify = async (url: string, params: string | null = null) => {\r\n\tconst spotifyApiUrl = \"https://api.spotify.com/v1\";\r\n\tif (!params) {\r\n\t\tthrow new Error(\"No parameters provided\");\r\n\t}\r\n\r\n\tconst tempToken = await getSpotifyToken();\r\n\tconst response = await fetch(`${spotifyApiUrl}/${url}/${params}`, {\r\n\t\theaders: {\r\n\t\t\tAuthorization: `Bearer ${tempToken}`,\r\n\t\t},\r\n\t});\r\n\r\n\tif (!response.ok) {\r\n\t\tthrow new Error(`HTTP error! status: ${response.status}; message: ${response.statusText}`);\r\n\t}\r\n\r\n\treturn response.json();\r\n};\r\n","import { SpotifyPlaylist, SpotifySearch, SpotifyTrack } from \"../../types/types\";\r\nimport { fetchFromSpotify } from \"../utils\";\r\n\r\nexport const searchTrack = async (query: string) => {\r\n\tif (!query) {\r\n\t\tthrow new Error(\"No query provided\");\r\n\t}\r\n\r\n\tconst data: SpotifySearch = await fetchFromSpotify(\"search\", `?q=${query}&type=track&limit=5`);\r\n\r\n\treturn data.tracks.items;\r\n};\r\n\r\nexport const searchPlaylist = async (query: string) => {\r\n\tif (!query) {\r\n\t\tthrow new Error(\"No query provided\");\r\n\t}\r\n\r\n\tconst data: SpotifySearch = await fetchFromSpotify(\"search\", `?q=${query}&type=playlist&limit=5`);\r\n\r\n\treturn data.playlists.items;\r\n};\r\n\r\nexport const getTrackInfo = async (id: string) => {\r\n\tif (!id) {\r\n\t\tthrow new Error(\"No ID provided\");\r\n\t}\r\n\r\n\tconst data: SpotifyTrack = await fetchFromSpotify(\"tracks\", id);\r\n\r\n\treturn data;\r\n};\r\n\r\nexport const getPlaylist = async (id: string) => {\r\n\tif (!id) {\r\n\t\tthrow new Error(\"No ID provided\");\r\n\t}\r\n\r\n\tconst data: SpotifyPlaylist = await fetchFromSpotify(\"playlists\", id);\r\n\r\n\treturn data;\r\n};\r\n","export const validateID = (id: string): boolean => {\r\n\tif (!id) false;\r\n\tif (typeof id !== \"string\") return false;\r\n\r\n\tconst base62Regex = /^[a-zA-Z0-9]+$/;\r\n\tif (!base62Regex.test(id)) return false;\r\n\r\n\treturn true;\r\n};\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAA,qBAAqB;AAEd,IAAM,kBAAkB,MAAoC;AAClE,MAAI;AACH,UAAM,MAAM;AACZ,UAAM,WAAW,MAAM,MAAM,KAAK;AAAA,MACjC,SAAS;AAAA,QACR,cACC;AAAA,MACF;AAAA,IACD,CAAC;AACD,UAAM,OAAO,MAAM,SAAS,KAAK;AAEjC,UAAM,QAAI,qBAAK,IAAI;AACnB,UAAM,iBAAiB,EAAE,UAAU,EAAE,KAAK;AAE1C,QAAI,CAAC,gBAAgB;AACpB,aAAO;AAAA,IACR;AAEA,UAAM,EAAE,YAAY,IAAI,KAAK,MAAM,cAAc;AAEjD,WAAO;AAAA,EACR,SAAS,OAAO;AACf,UAAM,IAAI,MAAM,6BAA6B,KAAK;AAAA,EACnD;AACD;AAEO,IAAM,mBAAmB,CAAO,KAAa,SAAwB,SAAS;AACpF,QAAM,gBAAgB;AACtB,MAAI,CAAC,QAAQ;AACZ,UAAM,IAAI,MAAM,wBAAwB;AAAA,EACzC;AAEA,QAAM,YAAY,MAAM,gBAAgB;AACxC,QAAM,WAAW,MAAM,MAAM,GAAG,aAAa,IAAI,GAAG,IAAI,MAAM,IAAI;AAAA,IACjE,SAAS;AAAA,MACR,eAAe,UAAU,SAAS;AAAA,IACnC;AAAA,EACD,CAAC;AAED,MAAI,CAAC,SAAS,IAAI;AACjB,UAAM,IAAI,MAAM,uBAAuB,SAAS,MAAM,cAAc,SAAS,UAAU,EAAE;AAAA,EAC1F;AAEA,SAAO,SAAS,KAAK;AACtB;;;AC3CO,IAAM,cAAc,CAAO,UAAkB;AACnD,MAAI,CAAC,OAAO;AACX,UAAM,IAAI,MAAM,mBAAmB;AAAA,EACpC;AAEA,QAAM,OAAsB,MAAM,iBAAiB,UAAU,MAAM,KAAK,qBAAqB;AAE7F,SAAO,KAAK,OAAO;AACpB;AAEO,IAAM,iBAAiB,CAAO,UAAkB;AACtD,MAAI,CAAC,OAAO;AACX,UAAM,IAAI,MAAM,mBAAmB;AAAA,EACpC;AAEA,QAAM,OAAsB,MAAM,iBAAiB,UAAU,MAAM,KAAK,wBAAwB;AAEhG,SAAO,KAAK,UAAU;AACvB;AAEO,IAAM,eAAe,CAAO,OAAe;AACjD,MAAI,CAAC,IAAI;AACR,UAAM,IAAI,MAAM,gBAAgB;AAAA,EACjC;AAEA,QAAM,OAAqB,MAAM,iBAAiB,UAAU,EAAE;AAE9D,SAAO;AACR;AAEO,IAAM,cAAc,CAAO,OAAe;AAChD,MAAI,CAAC,IAAI;AACR,UAAM,IAAI,MAAM,gBAAgB;AAAA,EACjC;AAEA,QAAM,OAAwB,MAAM,iBAAiB,aAAa,EAAE;AAEpE,SAAO;AACR;;;ACzCO,IAAM,aAAa,CAAC,OAAwB;AAClD,MAAI,CAAC;AAAI;AACT,MAAI,OAAO,OAAO;AAAU,WAAO;AAEnC,QAAM,cAAc;AACpB,MAAI,CAAC,YAAY,KAAK,EAAE;AAAG,WAAO;AAElC,SAAO;AACR;","names":[]}